<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP-–õ–æ—è–ª—å–Ω–æ—Å—Ç—å FunPay</title>
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --dark: #2d3436;
            --light: #f5f6fa;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #d63031;
        }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .user-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }
        .level-badge {
            display: inline-block;
            padding: 5px 15px;
            background: var(--primary);
            color: white;
            border-radius: 20px;
            font-weight: 700;
            margin-top: 10px;
        }
        .progress-container {
            margin: 25px 0;
        }
        .progress-bar {
            height: 10px;
            background: #dfe6e9;
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            width: 0%;
            transition: width 0.5s ease;
        }
        .promo-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .promo-card {
            background: var(--light);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .promo-code {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: var(--danger);
            background: #ffeaa7;
            padding: 3px 8px;
            border-radius: 4px;
        }
        .rules {
            margin-top: 40px;
        }
        .rule {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary);
            transition: transform 0.3s ease;
        }
        .rule:hover {
            transform: translateY(-3px);
        }
        .rule-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .rule-title {
            font-weight: 700;
            color: var(--dark);
        }
        .rule-level {
            background: var(--primary);
            color: white;
            padding: 3px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 700;
        }
        .hidden {
            display: none;
        }
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            margin: 5px;
        }
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
        }
        .test-buttons {
            text-align: center;
            margin: 30px 0;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1>üåü VIP-–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ FunPay</h1>
            <p>–ü–æ–∫—É–ø–∞–π—Ç–µ –±–æ–ª—å—à–µ - –ø–æ–ª—É—á–∞–π—Ç–µ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –≤—ã–≥–æ–¥—ã!</p>
        </header>
        
        <div class="user-card">
            <h2>–í–∞—à —Å—Ç–∞—Ç—É—Å</h2>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="totalPurchases">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–∫—É–ø–æ–∫</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="totalAmount">0</div>
                    <div class="stat-label">–û–±—â–∞—è —Å—É–º–º–∞ (—Ä—É–±)</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="currentLevelValue">0</div>
                    <div class="stat-label">–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å</div>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>0</span>
                    <span id="nextLevelLabel">5 –ø–æ–∫—É–ø–æ–∫</span>
                </div>
            </div>
            
            <div>
                –°—Ç–∞—Ç—É—Å: <span class="level-badge" id="currentLevel">–ù–æ–≤–∏—á–æ–∫</span>
            </div>
        </div>

        <div class="promo-section hidden" id="promoSection">
            <h2>üéÅ –í–∞—à–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã</h2>
            <div id="promoList"></div>
        </div>

        <div class="rules">
            <h2>üìú –£—Ä–æ–≤–Ω–∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏</h2>
            
            <!-- –ü—Ä–∞–≤–∏–ª–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            <div id="rulesList"></div>
        </div>
        
        <div class="test-buttons">
            <button class="btn" onclick="simulatePurchase(5, 25)">–¢–µ—Å—Ç: 5 –ø–æ–∫—É–ø–æ–∫ (25 —Ä—É–±)</button>
            <button class="btn" onclick="simulatePurchase(20, 1000)">–¢–µ—Å—Ç: 20 –ø–æ–∫—É–ø–æ–∫ (1000 —Ä—É–±)</button>
            <button class="btn" onclick="simulatePurchase(100, 5000)">–¢–µ—Å—Ç: 100 –ø–æ–∫—É–ø–æ–∫ (5000 —Ä—É–±)</button>
            <button class="btn" onclick="resetData()">–°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>
    </div>

    <script>
        // –ü–∞—Ä—Å–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å FunPay
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id') || 'user_' + Math.floor(Math.random() * 10000);
        const refSource = urlParams.get('ref') || 'direct';
        
        // –í—Å–µ 21 —É—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
        const loyaltyLevels = [
            { level: 1, purchases: 5, amount: 25, 
              reward: "–°–∫–∏–¥–∫–∞ 3% –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–≤–∞—Ä", 
              code: "LEVEL1_3PERCENT" },
            
            { level: 2, purchases: 10, amount: 100, 
              reward: "–°–∫–∏–¥–∫–∞ 10 —Ä—É–±–ª–µ–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–≤–∞—Ä", 
              code: "LEVEL2_10RUB" },
            
            { level: 3, purchases: 15, amount: 300, 
              reward: "–°–∫–∏–¥–∫–∞ 20 —Ä—É–±–ª–µ–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–≤–∞—Ä", 
              code: "LEVEL3_20RUB" },
            
            { level: 4, purchases: 20, amount: 1000, 
              reward: "–°–∫–∏–¥–∫–∞ 50 —Ä—É–±–ª–µ–π (–º–∞–∫—Å. —á–µ–∫ 1000 —Ä—É–±)", 
              code: "LEVEL4_50RUB" },
            
            { level: 5, purchases: 25, amount: 750, 
              reward: "–°–∫–∏–¥–∫–∞ 10% –Ω–∞ –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–∫–∞–∑–æ–≤", 
              code: "LEVEL5_10PERCENT" },
            
            { level: 6, purchases: 30, amount: 3000, 
              reward: "–°–∫–∏–¥–∫–∞ 100 —Ä—É–±–ª–µ–π –Ω–∞ –ª—é–±–æ–π —Ç–æ–≤–∞—Ä", 
              code: "LEVEL6_100RUB" },
            
            { level: 7, purchases: 40, amount: 400, 
              reward: "–ö–∞–∂–¥—ã–π 5-–π —Ç–æ–≤–∞—Ä –±–µ—Å–ø–ª–∞—Ç–Ω–æ", 
              code: "LEVEL7_FREE5" },
            
            { level: 8, purchases: 50, amount: 1000, 
              reward: "–°–∫–∏–¥–∫–∞ 200 —Ä—É–±–ª–µ–π –Ω–∞ –æ–±—â–∏–π –∑–∞–∫–∞–∑", 
              code: "LEVEL8_200RUB" },
            
            { level: 9, purchases: 60, amount: 1500, 
              reward: "–°–∫–∏–¥–∫–∞ 15% –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–∫–∞–∑", 
              code: "LEVEL9_15PERCENT" },
            
            { level: 10, purchases: 70, amount: 1050, 
              reward: "–°–∫–∏–¥–∫–∞ 150 —Ä—É–±–ª–µ–π –Ω–∞ –ª—é–±–æ–π —Ç–æ–≤–∞—Ä", 
              code: "LEVEL10_150RUB" },
            
            { level: 11, purchases: 80, amount: 2400, 
              reward: "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –±–æ–Ω—É—Å–Ω—ã–π —Ç–æ–≤–∞—Ä", 
              code: "LEVEL11_FREEGIFT" },
            
            { level: 12, purchases: 90, amount: 3600, 
              reward: "–°–∫–∏–¥–∫–∞ 300 —Ä—É–±–ª–µ–π –Ω–∞ –≤—Å—ë", 
              code: "LEVEL12_300RUB" },
            
            { level: 13, purchases: 100, amount: 5000, 
              reward: "–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ 100 —Ä—É–±–ª–µ–π", 
              code: "LEVEL13_100PROMO" },
            
            { level: 14, purchases: 120, amount: 7200, 
              reward: "2 —Ç–æ–≤–∞—Ä–∞ –≤ –ø–æ–¥–∞—Ä–æ–∫", 
              code: "LEVEL14_2FREE" },
            
            { level: 15, purchases: 150, amount: 10500, 
              reward: "–°–∫–∏–¥–∫–∞ 500 —Ä—É–±–ª–µ–π –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–∫–∞–∑", 
              code: "LEVEL15_500RUB" },
            
            { level: 16, purchases: 200, amount: 20000, 
              reward: "–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ –ª—é–±–æ–π —Ç–æ–≤–∞—Ä –¥–æ 300 —Ä—É–±", 
              code: "LEVEL16_300PROMO" },
            
            { level: 17, purchases: 250, amount: 20000, 
              reward: "–°–∫–∏–¥–∫–∞ 10% –Ω–∞ —Ç—Ä–∏ –∑–∞–∫–∞–∑–∞", 
              code: "LEVEL17_10PERCENT3" },
            
            { level: 18, purchases: 300, amount: 27000, 
              reward: "–°–∫–∏–¥–∫–∞ 1000 —Ä—É–±–ª–µ–π –Ω–∞ –≤—Å—ë", 
              code: "LEVEL18_1000RUB" },
            
            { level: 19, purchases: 350, amount: 35000, 
              reward: "–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ 24 —á–∞—Å–∞", 
              code: "LEVEL19_UNLIMITED" },
            
            { level: 20, purchases: 500, amount: 75000, 
              reward: "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–∞–π—Å –∏ VIP-—Å—Ç–∞—Ç—É—Å", 
              code: "LEVEL20_VIP" },
            
            { level: 21, purchases: 100, amount: 10000, 
              reward: "–õ—é–±–æ–π —Ç–æ–≤–∞—Ä + VIP-—Å—Ç–∞—Ç—É—Å", 
              code: "LEVEL21_VIPGIFT" }
        ];

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = JSON.parse(localStorage.getItem(userId)) || {
            id: userId,
            totalPurchases: 0,
            totalAmount: 0,
            promoCodes: [],
            refSource: refSource,
            lastPurchase: null
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initPage() {
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø—Ä–∞–≤–∏–ª–∞
            const rulesList = document.getElementById('rulesList');
            rulesList.innerHTML = '';
            
            loyaltyLevels.forEach(rule => {
                const ruleElement = document.createElement('div');
                ruleElement.className = 'rule';
                
                ruleElement.innerHTML = `
                    <div class="rule-header">
                        <span class="rule-title">–£—Ä–æ–≤–µ–Ω—å ${rule.level}: ${rule.purchases} –ø–æ–∫—É–ø–æ–∫ √ó ${rule.amount/rule.purchases} —Ä—É–±</span>
                        <span class="rule-level">${rule.purchases} —à—Ç / ${rule.amount} —Ä—É–±</span>
                    </div>
                    <div>${rule.reward} <span class="promo-code">${rule.code}</span></div>
                `;
                
                rulesList.appendChild(ruleElement);
            });
            
            updateUI();
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        function updateUI() {
            document.getElementById('totalPurchases').textContent = userData.totalPurchases;
            document.getElementById('totalAmount').textContent = userData.totalAmount.toLocaleString();
            
            checkLoyaltyLevel();
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
        function checkLoyaltyLevel() {
            let currentLevel = { level: 0, purchases: 0, amount: 0 };
            let nextLevel = loyaltyLevels[0];
            let hasNewRewards = false;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —É—Ä–æ–≤–Ω–∏
            loyaltyLevels.forEach(level => {
                if (userData.totalPurchases >= level.purchases && 
                    userData.totalAmount >= level.amount) {
                    
                    currentLevel = level;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥
                    if (!userData.promoCodes.includes(level.code)) {
                        userData.promoCodes.push(level.code);
                        hasNewRewards = true;
                    }
                } else if (!nextLevel && (userData.totalPurchases < level.purchases || 
                          userData.totalAmount < level.amount)) {
                    nextLevel = level;
                }
            });
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            let progress = 0;
            if (nextLevel) {
                const purchasesProgress = (userData.totalPurchases - currentLevel.purchases) / 
                                         (nextLevel.purchases - currentLevel.purchases) * 100;
                const amountProgress = (userData.totalAmount - currentLevel.amount) / 
                                      (nextLevel.amount - currentLevel.amount) * 100;
                progress = Math.min(100, Math.max(0, (purchasesProgress + amountProgress) / 2));
                
                document.getElementById('nextLevelLabel').textContent = 
                    `${nextLevel.purchases} –ø–æ–∫—É–ø–æ–∫ / ${nextLevel.amount} —Ä—É–±`;
            } else {
                document.getElementById('nextLevelLabel').textContent = "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å!";
                progress = 100;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('currentLevel').textContent = 
                currentLevel.level > 0 ? `–£—Ä–æ–≤–µ–Ω—å ${currentLevel.level}` : "–ù–æ–≤–∏—á–æ–∫";
            document.getElementById('currentLevelValue').textContent = 
                currentLevel.level > 0 ? currentLevel.level : "0";
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–º–æ–∫–æ–¥—ã, –µ—Å–ª–∏ –µ—Å—Ç—å
            if (userData.promoCodes.length > 0 || hasNewRewards) {
                showPromoCodes();
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            localStorage.setItem(userId, JSON.stringify(userData));
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–º–æ–∫–æ–¥—ã
        function showPromoCodes() {
            const promoSection = document.getElementById('promoSection');
            const promoList = document.getElementById('promoList');
            
            promoList.innerHTML = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã (–ø–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–º —É—Ä–æ–≤–Ω—è–º)
            const activeLevels = loyaltyLevels.filter(level => 
                userData.totalPurchases >= level.purchases && 
                userData.totalAmount >= level.amount);
            
            activeLevels.forEach(level => {
                if (userData.promoCodes.includes(level.code)) {
                    const promoCard = document.createElement('div');
                    promoCard.className = 'promo-card';
                    
                    promoCard.innerHTML = `
                        <div>${level.reward}</div>
                        <div class="promo-code">${level.code}</div>
                    `;
                    
                    promoList.appendChild(promoCard);
                }
            });
            
            promoSection.classList.remove('hidden');
        }

        // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ (–¥–ª—è —Ç–µ—Å—Ç–∞)
        function simulatePurchase(items, amount) {
            userData.totalPurchases += items;
            userData.totalAmount += amount;
            userData.lastPurchase = new Date().toISOString();
            
            updateUI();
            
            // –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å FunPay:
            console.log(`–ó–∞–ø–∏—Å—å –ø–æ–∫—É–ø–∫–∏: ${items} —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ ${amount} —Ä—É–±`);
        }

        // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è —Ç–µ—Å—Ç–∞)
        function resetData() {
            userData = {
                id: userId,
                totalPurchases: 0,
                totalAmount: 0,
                promoCodes: [],
                refSource: refSource,
                lastPurchase: null
            };
            
            localStorage.setItem(userId, JSON.stringify(userData));
            updateUI();
            document.getElementById('promoSection').classList.add('hidden');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        initPage();
        
        // –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å FunPay
        console.log(`–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FunPay. User ID: ${userId}, Source: ${refSource}`);
        console.log("–î–ª—è —Ç–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ simulatePurchase(–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Å—É–º–º–∞)");
    </script>
</body>
</html>